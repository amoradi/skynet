<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif">
  <defs>
    <!-- Gradients -->
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <linearGradient id="ingestionGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316"/>
      <stop offset="100%" style="stop-color:#ea580c"/>
    </linearGradient>
    <linearGradient id="storageGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
    <linearGradient id="transformGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="analysisGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899"/>
      <stop offset="100%" style="stop-color:#db2777"/>
    </linearGradient>
    <linearGradient id="servingGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#06b6d4"/>
      <stop offset="100%" style="stop-color:#0891b2"/>
    </linearGradient>

    <!-- Drop shadow -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.3"/>
    </filter>
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="url(#bgGradient)"/>

  <!-- Grid pattern -->
  <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#334155" stroke-width="0.5" opacity="0.3"/>
  </pattern>
  <rect width="1200" height="900" fill="url(#grid)"/>

  <!-- Title -->
  <text x="600" y="45" text-anchor="middle" fill="#f8fafc" font-size="28" font-weight="700" letter-spacing="2">MARKET RELATIONSHIP DISCOVERY</text>
  <text x="600" y="70" text-anchor="middle" fill="#94a3b8" font-size="14" font-weight="400">Data Pipeline Architecture</text>

  <!-- DATA SOURCES ROW -->
  <g transform="translate(100, 95)">
    <!-- Source boxes -->
    <g filter="url(#shadow)">
      <rect x="0" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="47" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">SEC</text>
      <text x="47" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">EDGAR</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="110" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="157" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">FED</text>
      <text x="157" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">FRED</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="220" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="267" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">NEWS</text>
      <text x="267" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">GDELT</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="330" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="377" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">CONFLICT</text>
      <text x="377" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">ACLED</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="440" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="487" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">ENERGY</text>
      <text x="487" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">EIA</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="550" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="597" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">PREDICTIONS</text>
      <text x="597" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">Polymarket</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="660" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="707" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">FLIGHTS</text>
      <text x="707" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">OpenSky</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="770" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="817" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">GEO</text>
      <text x="817" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">NASA/USGS</text>
    </g>
    <g filter="url(#shadow)">
      <rect x="880" y="0" width="95" height="50" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
      <text x="927" y="22" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600">INTERNET</text>
      <text x="927" y="38" text-anchor="middle" fill="#e2e8f0" font-size="12" font-weight="500">Cloudflare</text>
    </g>
  </g>

  <!-- Arrow down from sources -->
  <path d="M 600 155 L 600 175" stroke="#f97316" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <defs>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#f97316"/>
    </marker>
  </defs>

  <!-- INGESTION LAYER -->
  <g transform="translate(150, 180)" filter="url(#shadow)">
    <rect width="900" height="70" rx="12" fill="#1e293b" stroke="url(#ingestionGrad)" stroke-width="2"/>
    <rect x="0" y="0" width="8" height="70" rx="4" fill="url(#ingestionGrad)"/>
    <text x="30" y="28" fill="#f97316" font-size="11" font-weight="700" letter-spacing="1">INGESTION LAYER</text>
    <text x="30" y="50" fill="#94a3b8" font-size="12">EventBridge Scheduled Triggers → AWS Lambda Functions</text>

    <!-- NestJS badge -->
    <g transform="translate(780, 15)">
      <rect width="100" height="40" rx="6" fill="#e0234e" opacity="0.15"/>
      <text x="50" y="25" text-anchor="middle" fill="#e0234e" font-size="11" font-weight="600">NestJS Cron</text>
    </g>
  </g>

  <!-- Arrow down -->
  <path d="M 600 260 L 600 280" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <defs>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#3b82f6"/>
    </marker>
  </defs>

  <!-- RAW LAYER (S3) -->
  <g transform="translate(150, 285)" filter="url(#shadow)">
    <rect width="900" height="80" rx="12" fill="#1e293b" stroke="url(#storageGrad)" stroke-width="2"/>
    <rect x="0" y="0" width="8" height="80" rx="4" fill="url(#storageGrad)"/>
    <text x="30" y="28" fill="#3b82f6" font-size="11" font-weight="700" letter-spacing="1">RAW LAYER</text>
    <text x="30" y="50" fill="#e2e8f0" font-size="12" font-weight="500">s3://market-discovery-raw/{source}/{date}/*.json</text>
    <text x="30" y="68" fill="#64748b" font-size="11">Immutable • Append-only • Schema-on-read • Partitioned by source/date</text>

    <!-- S3 badge -->
    <g transform="translate(780, 20)">
      <rect width="100" height="40" rx="6" fill="#ff9900" opacity="0.15"/>
      <text x="50" y="25" text-anchor="middle" fill="#ff9900" font-size="11" font-weight="600">Amazon S3</text>
    </g>
  </g>

  <!-- Arrow with label -->
  <path d="M 600 375 L 600 395" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arrowPurple)"/>
  <text x="660" y="388" fill="#64748b" font-size="10">S3 Event → SQS</text>
  <defs>
    <marker id="arrowPurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#8b5cf6"/>
    </marker>
  </defs>

  <!-- TRANSFORM LAYER -->
  <g transform="translate(150, 400)" filter="url(#shadow)">
    <rect width="900" height="70" rx="12" fill="#1e293b" stroke="url(#transformGrad)" stroke-width="2"/>
    <rect x="0" y="0" width="8" height="70" rx="4" fill="url(#transformGrad)"/>
    <text x="30" y="28" fill="#8b5cf6" font-size="11" font-weight="700" letter-spacing="1">TRANSFORM LAYER</text>
    <text x="30" y="50" fill="#94a3b8" font-size="12">Normalize to unified schema • Dedupe • Validate • Enrich • Idempotent</text>

    <!-- Lambda badge -->
    <g transform="translate(780, 15)">
      <rect width="100" height="40" rx="6" fill="#ff9900" opacity="0.15"/>
      <text x="50" y="25" text-anchor="middle" fill="#ff9900" font-size="11" font-weight="600">Lambda/Step</text>
    </g>
  </g>

  <!-- Arrow down -->
  <path d="M 600 480 L 600 500" stroke="#10b981" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <defs>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#10b981"/>
    </marker>
  </defs>

  <!-- UNIFIED LAYER (PostgreSQL) -->
  <g transform="translate(150, 505)" filter="url(#shadow)">
    <rect width="900" height="115" rx="12" fill="#1e293b" stroke="url(#dbGrad)" stroke-width="2"/>
    <rect x="0" y="0" width="8" height="115" rx="4" fill="url(#dbGrad)"/>
    <text x="30" y="28" fill="#10b981" font-size="11" font-weight="700" letter-spacing="1">UNIFIED LAYER</text>

    <!-- Tables -->
    <g transform="translate(30, 40)">
      <rect width="200" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="10" y="20" fill="#10b981" font-size="10" font-weight="600">events</text>
      <text x="10" y="38" fill="#94a3b8" font-size="9">timestamp, source, event_type</text>
      <text x="10" y="52" fill="#94a3b8" font-size="9">entity, value, metadata (JSONB)</text>
    </g>
    <g transform="translate(250, 40)">
      <rect width="200" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="10" y="20" fill="#10b981" font-size="10" font-weight="600">market_data</text>
      <text x="10" y="38" fill="#94a3b8" font-size="9">timestamp, asset, price</text>
      <text x="10" y="52" fill="#94a3b8" font-size="9">volume, open, high, low, close</text>
    </g>
    <g transform="translate(470, 40)">
      <rect width="200" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="10" y="20" fill="#10b981" font-size="10" font-weight="600">relationships</text>
      <text x="10" y="38" fill="#94a3b8" font-size="9">source_event, target_asset</text>
      <text x="10" y="52" fill="#94a3b8" font-size="9">correlation, p_value, lag_days</text>
    </g>

    <!-- Postgres badge -->
    <g transform="translate(730, 40)">
      <rect width="150" height="65" rx="6" fill="#336791" opacity="0.15"/>
      <text x="75" y="25" text-anchor="middle" fill="#336791" font-size="11" font-weight="600">PostgreSQL</text>
      <text x="75" y="42" text-anchor="middle" fill="#336791" font-size="10">+ TimescaleDB</text>
      <text x="75" y="56" text-anchor="middle" fill="#64748b" font-size="9">Hypertables</text>
    </g>
  </g>

  <!-- Split arrows -->
  <path d="M 450 630 L 350 660" stroke="#ec4899" stroke-width="2" marker-end="url(#arrowPink)"/>
  <path d="M 750 630 L 850 660" stroke="#06b6d4" stroke-width="2" marker-end="url(#arrowCyan)"/>
  <defs>
    <marker id="arrowPink" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#ec4899"/>
    </marker>
    <marker id="arrowCyan" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#06b6d4"/>
    </marker>
  </defs>

  <!-- ANALYSIS LAYER -->
  <g transform="translate(80, 670)" filter="url(#shadow)">
    <rect width="430" height="140" rx="12" fill="#1e293b" stroke="url(#analysisGrad)" stroke-width="2"/>
    <rect x="0" y="0" width="8" height="140" rx="4" fill="url(#analysisGrad)"/>
    <text x="30" y="28" fill="#ec4899" font-size="11" font-weight="700" letter-spacing="1">ANALYSIS LAYER</text>
    <text x="30" y="48" fill="#64748b" font-size="10">Python Workers (FastAPI :8001)</text>

    <!-- Analysis components -->
    <g transform="translate(30, 60)">
      <rect width="115" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="57" y="20" text-anchor="middle" fill="#ec4899" font-size="9" font-weight="600">Statistical</text>
      <text x="57" y="35" text-anchor="middle" fill="#94a3b8" font-size="8">Correlation</text>
      <text x="57" y="47" text-anchor="middle" fill="#94a3b8" font-size="8">Granger Causality</text>
      <text x="57" y="59" text-anchor="middle" fill="#64748b" font-size="8">scipy</text>
    </g>
    <g transform="translate(155, 60)">
      <rect width="115" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="57" y="20" text-anchor="middle" fill="#ec4899" font-size="9" font-weight="600">Sentiment</text>
      <text x="57" y="35" text-anchor="middle" fill="#94a3b8" font-size="8">Financial Text</text>
      <text x="57" y="47" text-anchor="middle" fill="#94a3b8" font-size="8">News Analysis</text>
      <text x="57" y="59" text-anchor="middle" fill="#64748b" font-size="8">FinBERT</text>
    </g>
    <g transform="translate(280, 60)">
      <rect width="115" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="57" y="20" text-anchor="middle" fill="#ec4899" font-size="9" font-weight="600">Hypothesis</text>
      <text x="57" y="35" text-anchor="middle" fill="#94a3b8" font-size="8">Event Studies</text>
      <text x="57" y="47" text-anchor="middle" fill="#94a3b8" font-size="8">CAR Analysis</text>
      <text x="57" y="59" text-anchor="middle" fill="#64748b" font-size="8">Bonferroni</text>
    </g>
  </g>

  <!-- SERVING LAYER -->
  <g transform="translate(690, 670)" filter="url(#shadow)">
    <rect width="430" height="140" rx="12" fill="#1e293b" stroke="url(#servingGrad)" stroke-width="2"/>
    <rect x="0" y="0" width="8" height="140" rx="4" fill="url(#servingGrad)"/>
    <text x="30" y="28" fill="#06b6d4" font-size="11" font-weight="700" letter-spacing="1">SERVING LAYER</text>
    <text x="30" y="48" fill="#64748b" font-size="10">NestJS API + Redis</text>

    <!-- API endpoints -->
    <g transform="translate(30, 60)">
      <rect width="180" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="90" y="18" text-anchor="middle" fill="#06b6d4" font-size="9" font-weight="600">REST API</text>
      <text x="10" y="34" fill="#94a3b8" font-size="9">/relationships</text>
      <text x="10" y="46" fill="#94a3b8" font-size="9">/events /hypotheses</text>
      <text x="10" y="58" fill="#94a3b8" font-size="9">/alerts</text>
    </g>
    <g transform="translate(220, 60)">
      <rect width="180" height="65" rx="6" fill="#0f172a" stroke="#334155"/>
      <text x="90" y="18" text-anchor="middle" fill="#06b6d4" font-size="9" font-weight="600">Redis</text>
      <text x="10" y="34" fill="#94a3b8" font-size="9">Rate Limiting</text>
      <text x="10" y="46" fill="#94a3b8" font-size="9">Hot Cache</text>
      <text x="10" y="58" fill="#94a3b8" font-size="9">Pub/Sub Real-time</text>
    </g>
  </g>

  <!-- Bidirectional arrow between Analysis and Serving -->
  <path d="M 520 740 L 680 740" stroke="#64748b" stroke-width="1.5" stroke-dasharray="4,4"/>
  <text x="600" y="735" text-anchor="middle" fill="#64748b" font-size="9">HTTP</text>

  <!-- Legend -->
  <g transform="translate(80, 835)">
    <text x="0" y="0" fill="#64748b" font-size="10" font-weight="600">TECHNOLOGIES:</text>
    <g transform="translate(100, -10)">
      <rect width="12" height="12" rx="2" fill="#e0234e"/>
      <text x="18" y="10" fill="#94a3b8" font-size="9">NestJS</text>
    </g>
    <g transform="translate(180, -10)">
      <rect width="12" height="12" rx="2" fill="#ff9900"/>
      <text x="18" y="10" fill="#94a3b8" font-size="9">AWS</text>
    </g>
    <g transform="translate(240, -10)">
      <rect width="12" height="12" rx="2" fill="#336791"/>
      <text x="18" y="10" fill="#94a3b8" font-size="9">PostgreSQL</text>
    </g>
    <g transform="translate(340, -10)">
      <rect width="12" height="12" rx="2" fill="#3776ab"/>
      <text x="18" y="10" fill="#94a3b8" font-size="9">Python</text>
    </g>
    <g transform="translate(420, -10)">
      <rect width="12" height="12" rx="2" fill="#dc382d"/>
      <text x="18" y="10" fill="#94a3b8" font-size="9">Redis</text>
    </g>
  </g>

  <!-- Version -->
  <text x="1120" y="880" text-anchor="end" fill="#475569" font-size="9">v1.0 • Feb 2026</text>
</svg>
